# ==========================================
# GLOBAL CONFIGURATION
# ==========================================
global_config:
  module: globals
  class: GlobalSettings

  temp_outdoor_map:
    dallas_outdoor_temp: 'sensor.froeling_temp_outside'
    outdoor_temp: 'sensor.temperature_and_humidity_sensor_outdoor_balkon_temperature'
    froeling_outside_temperature: 'sensor.froeling_boiler_outside_temp'
    garten_temp: 'sensor.temperature_and_humidity_sensor_outdoor_garten_temperature'
  
  heating_map:
    froeling_boiler_1_pump_control: 'sensor.froeling_boiler_pump_control'
    froeling_boiler_1_pump_on_off: 'binary_sensor.froeling_boiler_pump_status' 
    froeling_boiler_state: 'sensor.froeling_boiler_state'
    froeling_boiler_temp: 'sensor.froeling_boiler_temp'
    froeling_buffer_1_charge_state: 'sensor.froeling_buffer_charge_state'
    froeling_buffer_1_pump_control: 'sensor.froeling_buffer_pump_control'
    froeling_buffer_temp_1: 'sensor.froeling_buffer_temp_sensor_1'
    froeling_buffer_temp_2: 'sensor.froeling_buffer_temp_sensor_2'
    froeling_buffer_temp_3: 'sensor.froeling_buffer_temp_sensor_3'
    froeling_buffer_temp_4: 'sensor.froeling_buffer_temp_sensor_4'
    froeling_collector_flow_temp: 'sensor.froeling_collector_flow_temp'
    froeling_collector_pump_control: 'sensor.froeling_collector_pump_control'
    froeling_collector_return_temp: 'sensor.froeling_collector_return_temp'
    froeling_collector_temp: 'sensor.froeling_collector_temp'
    froeling_current_control_of_the_collector_boiler_pump: 'sensor.froeling_collector_boiler_pump_control'
    froeling_exhaust_temp: 'sensor.froeling_boiler_flue_gas_temp'
    froeling_hk2_flow_actual_temp: 'sensor.froeling_hk2_flow_actual_temp'
    froeling_hk2_flow_target_temp: 'sensor.froeling_hk2_flow_target_temp'
    froeling_hk2_pump_external: 'select.froeling_hk2_enabled'
    froeling_hk2_pump_on_off: 'binary_sensor.froeling_hk2_pump_status' 
    froeling_induced_draft_control: 'sensor.froeling_boiler_induced_draught_control'
    froeling_induced_draft_speed: 'sensor.froeling_boiler_induced_draught_speed'
    froeling_oxygen_controller: 'sensor.froeling_boiler_oxygen_controller'
    froeling_primary_air: 'sensor.froeling_boiler_primary_air'
    froeling_residual_oxygen_content: 'sensor.froeling_boiler_residual_oxygen_content'
    froeling_return_sensor: 'sensor.froeling_boiler_return_sensor'
    froeling_system_state: 'sensor.froeling_boiler_system_state'
    froeling_hk2_flow_target_temp_external: 'sensor.froeling_hk2_flow_target_temp'

  temp_room_map:
    stubbe: 'sensor.wall_thermostat_with_switching_output_for_brand_switches_stubbe_temperature'
    blueroom: 'sensor.temperature_and_humidity_sensor_blue_room_temperature'
    kuche: 'sensor.wall_thermostat_with_switching_output_for_brand_switches_kuche_temperature'
    stibbile: 'sensor.wall_thermostat_with_switching_output_for_brand_switches_stibbile_temperature'
    livingroom: 'sensor.temperature_and_humidity_sensor_living_room_temperature'
    kitchen: 'sensor.wall_thermostat_with_switching_output_for_brand_switches_kitchen_temperature'
    medroom: 'sensor.wall_thermostat_with_switching_output_for_brand_switches_med_temperature'
    bedroom: 'sensor.temperature_and_humidity_sensor_bedroom_temperature'
    hallway: 'sensor.temperature_and_humidity_sensor_hallway_temperature'
    hof: 'sensor.wall_thermostat_with_switching_output_for_brand_switches_hof_temperature'
    gang: 'sensor.temperature_and_humidity_sensor_gang_mama_temperature'
    bad: 'sensor.radiator_thermostat_evo_bad_temperature'
    wc: 'sensor.radiator_thermostat_evo_wc_temperature'
    bathroom: 'sensor.radiator_thermostat_evo_bathroom_temperature'

  valve_map:
    valve_stubbe: 'sensor.heating_circuit_5_stubbe_valve_position'
    valve_blueroom: 'sensor.heating_circuit_11_blueroom_valve_position'
    valve_stibbile: 'sensor.heating_circuit_1_stibbile_valve_position'
    valve_kuche: 'sensor.heating_circuit_7_kuche_valve_position'
    valve_bedroom: 'sensor.heating_circuit_3_bedroom_valve_position'
    valve_medroom: 'sensor.heating_circuit_4_med_valve_position'
    valve_livingroom: 'sensor.heating_circuit_9_living_room_valve_position'
    valve_kitchen: 'sensor.heating_circuit_12_kitchen_valve_position'
    valve_hallway: 'sensor.heating_circuit_9_hallway_valve_position'
    valve_gang: 'sensor.heating_circuit_11_gang_valve_position'
    valve_hof: 'sensor.heating_circuit_5_hof_ost_valve_position'

  energy_map:
    main_meter: 'sensor.goe_904101_cec_0_0'
    ev_charger: 'sensor.goe_240930_eto'
    tesla_added: 'sensor.tesla_energy_added'

  car_map:
    tracker: 'device_tracker.tesla_location_tracker'
    charger_plugged: 'binary_sensor.goe_240930_car_0'

  garage_map:
    door_state: 'binary_sensor.shelly1minig3_543204694e60_input_0_input'
    door_switch: 'input_boolean.garage_door'
    relay: 'switch.shelly1minig3_543204694e60_switch_0'
    autoclose_toggle: 'input_boolean.garage_autoclose'

  lock_map:
    nuki_lock: 'lock.smart_lock_ultra'
    lock_switch: 'input_boolean.front_door'

  system_map:
    last_update_tracker: 'input_text.goecontroller_last_update'
    regular_shutdown: 'input_boolean.regular_shutdown'
    appdaemon_running: 'input_boolean.appdaemon_running'


# ==========================================
# HEATING SYSTEM APPS
# ==========================================

# Master Supply Manager: Calculates target flow based on claims
heating_pump_control:
  module: heating_automation
  class: HeatSupplyManager
  telegram_id: 79867494
  dependencies:
    - global_config
    - heating_stubbe
    - heating_blueroom
    - heating_kuche
    - heating_stibbile
    - heating_livingroom
    - heating_kitchen
    - heating_medroom
    - heating_bedroom
    - heating_hallway
    - heating_hof
    - heating_gang

# Boiler Interface: Forwards calculation to physical hardware
froeling_interface:
  module: heating_froeling_esp
  class: FroelingHeatingESP
  telegram_id: 79867494
  dependencies:
    - global_config
    - heating_pump_control

# --- Standard Rooms (Trigger the pump) ---
heating_stubbe:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_blueroom:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_kuche:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_stibbile:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_livingroom:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_kitchen:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_medroom:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_bedroom:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_hallway:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_hof:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_gang:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

# --- Standalone Rooms (no pump trigger) ---
heating_bad:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_wc:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]

heating_bathroom:
  module: heating_automation
  class: RoomDemandCalculator
  dependencies: [global_config]
